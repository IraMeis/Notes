# Построение и исследование аппроксимации простейшей неявной разностной схемы для краевой задачи теплопроводности.
<span style="color: yellow;">`fas:Question`: Нужно ли расписывать исследование или можно сказать словами?</span>
Для построения неявной схемы для задачи [[Построение и исследование аппроксимации простейшей явной разностной схемы для краевой задачи теплопроводности.#5 1]] воспользуемся сеткой [[Построение разностных схем методом замены производных разностными отношениями. Схема Кранка-Николсона.#4 2 |4.2]]. Заменим производные следующими разностными отношениями: 
![[Построение разностных схем методом замены производных разностными отношениями. Схема Кранка-Николсона.#4 3]]
$$
\frac{ \partial u(x_{i},t_{k}) }{ \partial t } \approx \frac{u(x_{i}, t_{k} )-u(x_{i}, t_{k-1})}{h_{t}}
$$
$$
\frac{ \partial u(x_{I}, t_{k}) }{ \partial x } \approx \frac{u(x_{I}, t_{k})-u(x_{I-1},t_{k})}{2h_{x}}
$$
В результате получим следующую схему:
###### 5.9
$$
\begin{cases}
\frac{u_{i}^{k}-u_{i}^{k-1}}{h_{t}}=\left( \frac{u_{i+1}^k-2u_{i}^k+u_{i-1}^k}{h_{x}^2} \right) -Du_{i}^k, & i=\overline{1, I}, k=\overline{1, K}; \\
u_{i}^0=\psi(x_{i}), &i=\overline{0,I}; \\
u_{0}^k=0, & k=\overline{1,K} \\
\frac{u_{I}^k-u_{I-1}^k}{h_{x}}=0, & k=\overline{1,K}
\end{cases}
$$
# 

В отличие от явной схемы здесь мы использовали не центральную аппроксимацию производной в последнем граничном условии, а левую. Левая аппроксимация не использует узлов за пределами отрезка $0\leq x\leq l$ и, следовательно, может быть применена всегда, когда существует 61 левосторонняя производная $\frac{ \partial u(l,t_{k}) }{ \partial x }$. Для применения центральной аппроксимации необходимо, чтобы функция $u(x,t)$ была непрерывной по $x$ в некоторой двусторонней окрестности точки$x=l$ и имела в этой точке не одностороннюю производную, а обычную.

**Исследование аппроксимации неявной разностной схемы**

Невязка для этой схемы будет иметь структуру, аналогичную структуре невязки для простейшей явной схемы
###### 5.10
![[Построение и исследование аппроксимации простейшей явной разностной схемы для краевой задачи теплопроводности.#5 4]]
# 
Рассматривая отдельно каждую компоненту невязки [[#5 10]] и действуя по аналогии с исследованием аппроксимации простейшей явной схемы, получим:
![[Pasted image 20220610171841.png]]

При упрощении выражения для невязки $\left\{ \delta \hat{f}_{h}^4 \right\}_{x=x_{i}}^{t=t_{k}}$ было учтено граничное условие $u_{x}'\bigr|_{x=l}=0$ задачи [[Построение и исследование аппроксимации простейшей явной разностной схемы для краевой задачи теплопроводности.#5 1|5.1]]. Видим, что последнее разностное граничное условие схемы [[#5 9]] имеет лишь первый порядок аппроксимации по шагу $h_{x}$ , в то время, как дифференциальное уравнение задачи [[Построение и исследование аппроксимации простейшей явной разностной схемы для краевой задачи теплопроводности.#5 1|5.1]] аппроксимировано со вторым порядком.
Повысим порядок аппроксимации для четвертого соотношения схемы [[#5 9]]. Запишем четвертое соотношение (разностное граничное условие) схемы [[#5 9]] в виде
$$
	\frac{(u_{I}^k-u_{I-1}^k)}{h_{x}}=S^k
$$
В этом случае четвертая невязка будет иметь вид
![[Pasted image 20220610172250.png]]
Для того, чтобы рассматриваемое краевое условие имело второй порядок аппроксимации по шагу $h_{x}$ , необходимо, чтобы выполнялось условие:
###### 5.11
$$
			S^k=-\frac{h_{x}}{2}\left\{ u_{x}'' \right\}_{x=x_{I}}^{t=t_{k}} 
$$

Из дифференциального уравнения задачи [[Построение и исследование аппроксимации простейшей явной разностной схемы для краевой задачи теплопроводности.#5 1|5.1]] получаем:
###### 5.12
$$
	u_{x x}''=u_{t}'+Du
$$
# 
Подставим [[#5 12]] в [[#5 11]] и заменив производную по времени подходящим разностным отношением, получим:
$$
		S^k=-\frac{h_{x}}{2}\left[ \frac{u(x_{I},t_{k})-u(x_{I},t_{k-1})}{h_{t}}+Du(x_{I},t_{k}) \right] 
$$
Таким образом, окончательный вариант простейшей неявной разностной схемы будет выглядеть так:
###### 5.13
$$
\begin{cases}
\frac{u_{i}^{k}-u_{i}^{k-1}}{h_{t}}=\left( \frac{u_{i+1}^k-2u_{i}^k+u_{i-1}^k}{h_{x}^2} \right) -Du_{i}^k, & i=\overline{1, I}, k=\overline{1, K}; \\
u_{i}^0=\psi(x_{i}), &i=\overline{0,I}; \\
u_{0}^k=0, & k=\overline{1,K} \\
\frac{(u_{I}^k-u_{I-1}^k)}{h_{x}}=-\frac{h_{x}}{2}\left[ \frac{u_{I}^k-u_{I}^{k-1}}{h_{t}}+Du_{I}^k \right], & k=\overline{1,K}  
\end{cases}
$$
# 
Для этой схемы невязка имеет вид:
$$
\delta \hat{f}_{h}=\begin{Bmatrix}
\delta \hat{f}_{1} \\
\delta \hat{f}_{2} \\
\delta \hat{f}_{3} \\
\delta \hat{f}_{4} \\
\end{Bmatrix}=\begin{Bmatrix}
O(h_{x}^2,h_{t})\\
0 \\
0 \\
O(h_{x}^2)
\end{Bmatrix}
$$
Если определить норму в пространстве $F_{h}$ формулой [[Построение и исследование аппроксимации простейшей явной разностной схемы для краевой задачи теплопроводности.#5 7 |5.7]], то погрешность аппроксимации неявной схемы [[#5 13]] будет равна:
###### 5.14
$$
||\delta \hat{f}_{h}||=O(h_{x}^2,h_{t})+0+0+O(h_{x}^2)=O(h_{x}^2,h_{t})
$$
# 

Итак, простейшая неявная разностная схема [[#5 13]] аппроксимирует краевую задачу [[Построение и исследование аппроксимации простейшей явной разностной схемы для краевой задачи теплопроводности.#5 1]] на ее решении $u$, причем погрешность аппроксимации имеет второй порядок относительно шага $h_{x}$ и первый порядок относительно шага $h_{x}$.

Отметим, что схема [[#5 13]] представляет собой систему линейных алгебраических уравнений, которую можно записать в следующем векторноматричном виде:
###### 5.15
$$
\begin{cases}
	Pu^k=u^{k-1}, & l=\overline{1,K} \\
u^0=\psi
\end{cases}
$$
где
![[Pasted image 20220610173732.png]]
![[Pasted image 20220610173737.png]]

Для решения задачи [[#5 15]], представляющей собой СЛАУ с трехдиагональной матрицей, целесообразно использовать метод прогонки, устойчивость которой гарантируется выполнением неравенства:
$$
1+2\mu+Dh_{t}>2\mu
$$