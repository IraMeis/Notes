# Совместное применение методов пирамид и параллелепипедов
$\frac{\partial u}{\partial t} = a \frac{\partial^{2}u}{\partial x^{2}}+f(x)$
$\frac{u_{i}^{n+1}-u^{n}_{i}}{\tau}=a \frac{u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}}{h^{2}}+f_{i}$
$$w_{h}=\begin{cases}  
 (i, n): i=\overline{1, I}, n=\overline{1, N}, x:=(i-1)h \\
 h=\frac{X}{I}: T=\frac{\tau}{N}; t_{h}=(n-1)\tau
\end{cases}$$
Сеточная область почти совпадает с пространством итераций, в которое не входят узлы
Для простоты ограничимся построением двухзадачного параллельного алгоритма.
## A) Применяем метод параллепипедов (в чистом виде):
![[Pasted image 20220424232210.png]]
при работе на каждом слое задачам необходимо обмениваться пограничными значениями обычных функций
$T_{11}^{2}(\text{параллепипеда}=\frac{I*N}{2}\tau_{ap} (\text{Арифметическое состояние})+N\tau_{k} (Коммуникат. состояние))$
## B) Метод пирамид
![[Pasted image 20220424233359.png]]
$T_{11}^{2}(\text{пирамиды}=[\frac{N*I}{2}+\frac{1}{2}N^{2}](\text{Арифметическое состояние})\tau_{a}+0*\tau_{k}(Коммуникат. состояние)$
Если $\frac{1}{2}N^{2}\tau_{\alpha}<\tau_{k}N$, то лучшие  || алгоритм, построенный по методу пирамид 
$N \tau_{a} < 2 \tau_{k}$
Чем больше $N$, тем лучше ведёт себя метод параллепипедов
## C) Смешанный (гибридный) метод
![[Pasted image 20220424233920.png]]
Высота облака
При $\gamma=1$ - метод параллепипедов
При $\gamma=N$ - метод пирамид
Коммуникации сопровождают вычисление не при переходе на след. слой по времени, а при смене блочных временных слоёв.
![[Pasted image 20220424234123.png]]
![[Pasted image 20220424235031.png]]
... - данные, необходимые первой задаче для начала второй в след. слое
... - данные, необходимые второй задаче в начале вычислений на следующем блочном слое
$T_{11}^{2}(\text{гибрид})=\frac{N}{\gamma}[(\frac{\gamma * I}{2}+\frac{\gamma^{2}}{2})\tau_{ap}+\tau_{k}]=\frac{NI}{2}\tau_{ap}+\frac{N \gamma}{2}\tau_{ap}+\frac{N}{\gamma}\tau_{k}$
По сравнению с 1-м алгоритмом в $\gamma$ раз меньше коммуникаций, но на $\frac{N \gamma}{2}$ больше арифм. действий.
$\frac{N}{\gamma}$ меньше арифм. действий по сравнению со вторым алгоритмом, но на $\frac{N}{\gamma}$ больше коммуникаций.
$\frac{a[\frac{N\gamma}{2}\tau_{ap}+\frac{N}{\gamma}\tau_{n}]}{a \gamma}=\frac{N}{2}\tau_{ap}-2 (\frac{N}{\gamma^{2}})\tau_{n}$
$\frac{N}{2}\tau_{ap}-(\frac{N}{\gamma^{2}})\tau_{k}=0$
$\frac{N}{\gamma^{2}_{apt}}\tau_{k}=(\frac{N}{2})\tau_{ap}$
$\gamma_{opt}=\sqrt{\frac{2\tau_{k}}{\tau{ap}}}$
## D) Применение модификации метода пирамид для вычисления на видеопроцессорах
Задача
![[Pasted image 20220424235559.png]]
Преодоление ограничений на размер видеопамяти
$V_{\text{видеопамяти}} \ll V_{\text{оперативной памяти}}$
![[Pasted image 20220424235609.png]]
![[Pasted image 20220424235614.png]]